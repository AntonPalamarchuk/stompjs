!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("StompJs",[],t):"object"==typeof exports?exports.StompJs=t():e.StompJs=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=function(){function e(){}return e.client=function(t,n){null==n&&(n=["v10.stomp","v11.stomp","v12.stomp"]);return new r.Client(function(){return new(e.WebSocketClass||WebSocket)(t,n)})},e.over=function(e){var t="function"==typeof e?e:function(){return e};return new r.Client(t)},e.setInterval=function(e,t){setInterval(t,e)},e.clearInterval=function(e){clearInterval(e)},e.VERSIONS={V1_0:"1.0",V1_1:"1.1",V1_2:"1.2",supportedVersions:function(){return"1.2,1.1,1.0"}},e.WebSocketClass=null,e}();t.Stomp=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Byte={LF:"\n",NULL:"\0"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(){function e(e,t,n,r){void 0===t&&(t={}),void 0===n&&(n=""),void 0===r&&(r=!1),this.command=e,this.headers=t,this.body=n,this.escapeHeaderValues=r}return e.prototype.toString=function(){var t=[this.command],n=!1===this.headers["content-length"];n&&delete this.headers["content-length"];for(var i=0,o=Object.keys(this.headers||{});i<o.length;i++){var s=o[i],c=this.headers[s];this.escapeHeaderValues&&"CONNECT"!==this.command&&"CONNECTED"!==this.command?t.push(s+":"+e.frEscape(""+c)):t.push(s+":"+c)}return this.body&&!n&&t.push("content-length:"+e.sizeOfUTF8(this.body)),t.push(r.Byte.LF+this.body),t.join(r.Byte.LF)},e.sizeOfUTF8=function(e){return e?encodeURI(e).match(/%..|./g).length:0},e.unmarshallSingle=function(t,n){for(var i=t.search(new RegExp(""+r.Byte.LF+r.Byte.LF)),o=t.substring(0,i).split(r.Byte.LF),s=o.shift(),c={},a=function(e){return e.replace(/^\s+|\s+$/g,"")},u=0,f=o.reverse();u<f.length;u++){var l=f[u],p=l.indexOf(":");c[a(l.substring(0,p))]=n&&"CONNECT"!==s&&"CONNECTED"!==s?e.frUnEscape(a(l.substring(p+1))):a(l.substring(p+1))}var d="",h=i+2;if(c["content-length"]){var b=parseInt(c["content-length"]);d=(""+t).substring(h,h+b)}else for(var g=null,v=h,y=t.length,m=h<=y;(m?v<y:v>y)&&(g=t.charAt(v))!==r.Byte.NULL;m?v++:v--)d+=g;return new e(s,c,d,n)},e.unmarshall=function(t,n){null==n&&(n=!1);var i=t.split(new RegExp(""+r.Byte.NULL+r.Byte.LF+"*")),o={frames:[],partial:""};o.frames=i.slice(0,-1).map(function(t){return e.unmarshallSingle(t,n)});var s=i.slice(-1)[0];return s===r.Byte.LF||-1!==s.search(new RegExp(""+r.Byte.NULL+r.Byte.LF+"*$"))?o.frames.push(e.unmarshallSingle(s,n)):o.partial=s,o},e.marshall=function(t,n,i,o){return new e(t,n,i,o).toString()+r.Byte.NULL},e.frEscape=function(e){return e.replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/:/g,"\\c")},e.frUnEscape=function(e){return e.replace(/\\r/g,"\r").replace(/\\n/g,"\n").replace(/\\c/g,":").replace(/\\\\/g,"\\")},e}();t.Frame=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(0),o=n(1),s=function(){function e(e){this.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log.apply(console,e)},this.ws_fn=function(){var t=e();return t.binaryType="arraybuffer",t},this.reconnect_delay=0,this.counter=0,this.connected=!1,this.heartbeat={outgoing:1e4,incoming:1e4},this.maxWebSocketFrameSize=16384,this.subscriptions={},this.partialData=""}return e.now=function(){return Date.now?Date.now():(new Date).valueOf},e.prototype._transmit=function(e,t,n){void 0===n&&(n="");var i=r.Frame.marshall(e,t,n,this.escapeHeaderValues);for("function"==typeof this.debug&&this.debug(">>> "+i);;){if(!(i.length>this.maxWebSocketFrameSize))return void this.ws.send(i);this.ws.send(i.substring(0,this.maxWebSocketFrameSize)),i=i.substring(this.maxWebSocketFrameSize),"function"==typeof this.debug&&this.debug("remaining = "+i.length)}},e.prototype._setupHeartbeat=function(t){var n,r=this;if(t.version===i.Stomp.VERSIONS.V1_1||t.version===i.Stomp.VERSIONS.V1_2){var s=t["heart-beat"].split(",").map(function(e){return parseInt(e)}),c=s[0],a=s[1];return 0!==this.heartbeat.outgoing&&0!==a&&(n=Math.max(this.heartbeat.outgoing,a),"function"==typeof this.debug&&this.debug("send PING every "+n+"ms"),this.pinger=i.Stomp.setInterval(n,function(){return r.ws.send(o.Byte.LF),"function"==typeof r.debug?r.debug(">>> PING"):void 0})),0!==this.heartbeat.incoming&&0!==c?(n=Math.max(this.heartbeat.incoming,c),"function"==typeof this.debug&&this.debug("check PONG every "+n+"ms"),this.ponger=i.Stomp.setInterval(n,function(){var t=e.now()-r.serverActivity;if(t>2*n)return"function"==typeof r.debug&&r.debug("did not receive server activity for the last "+t+"ms"),r.ws.close()})):void 0}},e.prototype._parseConnect=function(){for(var e,t,n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o={};if(r.length<2)throw"Connect requires at least 2 arguments";if("function"==typeof r[1])o=r[0],t=r[1],n=r[2],e=r[3];else switch(r.length){case 6:o.login=r[0],o.passcode=r[1],t=r[2],n=r[3],e=r[4],o.host=r[5];break;default:o.login=r[0],o.passcode=r[1],t=r[2],n=r[3],e=r[4]}return[o,t,n,e]},e.prototype.connect=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.escapeHeaderValues=!1;var n=this._parseConnect.apply(this,e);return this.headers=n[0],this.connectCallback=n[1],this.errorCallback=n[2],this.closeEventCallback=n[3],this._active=!0,this._connect()},e.prototype._connect=function(){var t=this,n=this.headers,s=this.errorCallback,c=this.closeEventCallback;return this.debug(n),"function"==typeof this.debug&&this.debug("Opening Web Socket..."),this.ws=this.ws_fn(),this.ws.onmessage=function(n){t.debug("Received data");var c=function(){if("undefined"!=typeof ArrayBuffer&&n.data instanceof ArrayBuffer){var e=new Uint8Array(n.data);"function"==typeof t.debug&&t.debug("--- got data length: "+e.length);var r,i=void 0,o=void 0;for(o=[],i=0,r=e.length;i<r;i++){var s=e[i];o.push(String.fromCharCode(s))}return o.join("")}return n.data}();if(t.debug(c),t.serverActivity=e.now(),c!==o.Byte.LF){"function"==typeof t.debug&&t.debug("<<< "+c);var a=r.Frame.unmarshall(t.partialData+c,t.escapeHeaderValues);t.partialData=a.partial;for(var u=function(e){switch(e.command){case"CONNECTED":if("function"==typeof t.debug&&t.debug("connected to server "+e.headers.server),t.connected=!0,t.version=e.headers.version,t.version===i.Stomp.VERSIONS.V1_2&&(t.escapeHeaderValues=!0),!t._active)return t.disconnect(function(){}),{value:void 0};t._setupHeartbeat(e.headers),"function"==typeof t.connectCallback&&t.connectCallback(e);break;case"MESSAGE":var n=e.headers.subscription,r=t.subscriptions[n]||t.onreceive;if(r){var o,c=t;o=t.version===i.Stomp.VERSIONS.V1_2?e.headers.ack:e.headers["message-id"],e.ack=function(e){return null==e&&(e={}),c.ack(o,n,e)},e.nack=function(e){return null==e&&(e={}),c.nack(o,n,e)},r(e)}else"function"==typeof t.debug&&t.debug("Unhandled received MESSAGE: "+e);break;case"RECEIPT":e.headers["receipt-id"]===t.closeReceipt?(t.ws.onclose=null,t.ws.close(),t._cleanUp(),"function"==typeof t._disconnectCallback&&t._disconnectCallback()):"function"==typeof t.onreceipt&&t.onreceipt(e);break;case"ERROR":"function"==typeof s&&s(e);break;default:"function"==typeof t.debug&&t.debug("Unhandled frame: "+e)}},f=0,l=a.frames;f<l.length;f++){var p=u(l[f]);if("object"==typeof p)return p.value}}else"function"==typeof t.debug&&t.debug("<<< PONG")},this.ws.onclose=function(e){var n="Whoops! Lost connection to "+t.ws.url;return"function"==typeof t.debug&&t.debug(n),"function"==typeof c&&c(e),t._cleanUp(),"function"==typeof s&&s(n),t._schedule_reconnect()},this.ws.onopen=function(){"function"==typeof t.debug&&t.debug("Web Socket Opened..."),n["accept-version"]=i.Stomp.VERSIONS.supportedVersions(),n["heart-beat"]=[t.heartbeat.outgoing,t.heartbeat.incoming].join(","),t.debug(n),t._transmit("CONNECT",n)}},e.prototype._schedule_reconnect=function(){var e=this;if(this.reconnect_delay>0)return"function"==typeof this.debug&&this.debug("STOMP: scheduling reconnection in "+this.reconnect_delay+"ms"),this._reconnector=setTimeout(function(){return e.connected?"function"==typeof e.debug?e.debug("STOMP: already connected"):void 0:("function"==typeof e.debug&&e.debug("STOMP: attempting to reconnect"),e._connect())},this.reconnect_delay)},e.prototype.disconnect=function(e,t){if(void 0===t&&(t={}),this._disconnectCallback=e,this._active=!1,this.connected){t.receipt||(t.receipt="close-"+this.counter++),this.closeReceipt=t.receipt;try{return this._transmit("DISCONNECT",t)}catch(e){return"function"==typeof this.debug?this.debug("Ignoring error during disconnect",e):void 0}}},e.prototype._cleanUp=function(){if(this._reconnector&&clearTimeout(this._reconnector),this.connected=!1,this.subscriptions={},this.partial="",this.pinger&&i.Stomp.clearInterval(this.pinger),this.ponger)return i.Stomp.clearInterval(this.ponger)},e.prototype.send=function(e,t,n){return null==t&&(t={}),null==n&&(n=""),t.destination=e,this._transmit("SEND",t,n)},e.prototype.subscribe=function(e,t,n){null==n&&(n={}),n.id||(n.id="sub-"+this.counter++),n.destination=e,this.subscriptions[n.id]=t,this._transmit("SUBSCRIBE",n);var r=this;return{id:n.id,unsubscribe:function(e){return r.unsubscribe(n.id,e)}}},e.prototype.unsubscribe=function(e,t){return null==t&&(t={}),delete this.subscriptions[e],t.id=e,this._transmit("UNSUBSCRIBE",t)},e.prototype.begin=function(e){var t=e||"tx-"+this.counter++;this._transmit("BEGIN",{transaction:t});var n=this;return{id:t,commit:function(){return n.commit(t)},abort:function(){return n.abort(t)}}},e.prototype.commit=function(e){return this._transmit("COMMIT",{transaction:e})},e.prototype.abort=function(e){return this._transmit("ABORT",{transaction:e})},e.prototype.ack=function(e,t,n){return null==n&&(n={}),this.version===i.Stomp.VERSIONS.V1_2?n.id=e:n["message-id"]=e,n.subscription=t,this._transmit("ACK",n)},e.prototype.nack=function(e,t,n){return null==n&&(n={}),this.version===i.Stomp.VERSIONS.V1_2?n.id=e:n["message-id"]=e,n.subscription=t,this._transmit("NACK",n)},e}();t.Client=s},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(3)),r(n(2)),r(n(0))},function(e,t,n){e.exports=n(4)}])});
//# sourceMappingURL=stomp.umd.min.js.map