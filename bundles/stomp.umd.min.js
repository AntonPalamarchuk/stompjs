!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("StompJs",[],t):"object"==typeof exports?exports.StompJs=t():e.StompJs=t()}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.versions=function(){return[e.V1_0,e.V1_1,e.V1_2]},e.supportedVersions=function(){return e.versions().join(",")},e.protocolVersions=function(){return e.versions().map(function(e){return"v"+e.replace(".","")+".stomp"})},e.V1_0="1.0",e.V1_1="1.1",e.V1_2="1.2",e}();t.Versions=o},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t){var n=e.call(this)||this;return n._heartbeatInfo=new i(n),n.reconnect_delay=0,n.webSocketFactory=t,n.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log.apply(console,e)},n}return o(t,e),t.prototype._parseConnect=function(){for(var e,t,n,o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];var i={};if(o.length<2)throw"Connect requires at least 2 arguments";if("function"==typeof o[1])i=o[0],t=o[1],n=o[2],e=o[3];else switch(o.length){case 6:i.login=o[0],i.passcode=o[1],t=o[2],n=o[3],e=o[4],i.host=o[5];break;default:i.login=o[0],i.passcode=o[1],t=o[2],n=o[3],e=o[4]}return[i,t,n,e]},t.prototype.connect=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=this._parseConnect.apply(this,t);this.connectHeaders=o[0],this.onConnect=o[1],this.onStompError=o[2],this.onWebSocketClose=o[3],e.prototype.connect.call(this)},t.prototype.disconnect=function(t,n){void 0===n&&(n={}),t&&(this.onDisconnect=t),this.disconnectHeaders=n,e.prototype.disconnect.call(this)},Object.defineProperty(t.prototype,"reconnect_delay",{set:function(e){this.reconnectDelay=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ws",{get:function(){return this._webSocket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onreceive",{get:function(){return this.onUnhandledMessage},set:function(e){this.onUnhandledMessage=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onreceipt",{get:function(){return this.onReceipt},set:function(e){this.onReceipt=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"heartbeat",{get:function(){return this._heartbeatInfo},set:function(e){this.heartbeatIncoming=e.incoming,this.heartbeatOutgoing=e.outgoing},enumerable:!0,configurable:!0}),t}(n(4).Client);t.CompatClient=r;var i=function(){function e(e){this.client=e}return Object.defineProperty(e.prototype,"outgoing",{get:function(){return this.client.heartbeatOutgoing},set:function(e){this.client.heartbeatOutgoing=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"incoming",{get:function(){return this.client.heartbeatIncoming},set:function(e){this.client.heartbeatIncoming=e},enumerable:!0,configurable:!0}),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Byte={LF:"\n",NULL:"\0"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),r=function(){function e(e,t,n,o){void 0===t&&(t={}),void 0===n&&(n=""),void 0===o&&(o=!1),this.command=e,this.headers=t,this.body=n,this.escapeHeaderValues=o}return e.prototype.toString=function(){var t=[this.command],n=!1===this.headers["content-length"];n&&delete this.headers["content-length"];for(var r=0,i=Object.keys(this.headers||{});r<i.length;r++){var c=i[r],s=this.headers[c];this.escapeHeaderValues&&"CONNECT"!==this.command&&"CONNECTED"!==this.command?t.push(c+":"+e.frEscape(""+s)):t.push(c+":"+s)}return this.body&&!n&&t.push("content-length:"+e.sizeOfUTF8(this.body)),t.push(o.Byte.LF+this.body),t.join(o.Byte.LF)},e.sizeOfUTF8=function(e){return e?(encodeURI(e).match(/%..|./g)||[]).length:0},e.unmarshallSingle=function(t,n){for(var r=t.search(new RegExp(""+o.Byte.LF+o.Byte.LF)),i=t.substring(0,r).split(o.Byte.LF),c=i.shift(),s={},a=function(e){return e.replace(/^\s+|\s+$/g,"")},u=0,p=i.reverse();u<p.length;u++){var h=p[u],f=h.indexOf(":"),l=a(h.substring(0,f)),d=a(h.substring(f+1));n&&"CONNECT"!==c&&"CONNECTED"!==c&&(d=e.frUnEscape(d)),s[l]=d}var b="",g=r+2;if(s["content-length"]){var _=parseInt(s["content-length"]);b=(""+t).substring(g,g+_)}else for(var y=null,v=g,m=t.length,S=g<=m;(S?v<m:v>m)&&(y=t.charAt(v))!==o.Byte.NULL;S?v++:v--)b+=y;return new e(c,s,b,n)},e.unmarshall=function(t,n){null==n&&(n=!1);var r=t.split(new RegExp(""+o.Byte.NULL+o.Byte.LF+"*")),i={frames:[],partial:""};i.frames=r.slice(0,-1).map(function(t){return e.unmarshallSingle(t,n)});var c=r.slice(-1)[0];return c===o.Byte.LF||-1!==c.search(new RegExp(""+o.Byte.NULL+o.Byte.LF+"*$"))?i.frames.push(e.unmarshallSingle(c,n)):i.partial=c,i},e.marshall=function(t,n,r,i){return new e(t,n,r,i).toString()+o.Byte.NULL},e.frEscape=function(e){return e.replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/:/g,"\\c")},e.frUnEscape=function(e){return e.replace(/\\r/g,"\r").replace(/\\n/g,"\n").replace(/\\c/g,":").replace(/\\\\/g,"\\")},e}();t.Frame=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(2),i=n(0),c=function(){function e(e){void 0===e&&(e={}),this.reconnectDelay=5e3,this.heartbeatIncoming=1e4,this.heartbeatOutgoing=1e4,this.maxWebSocketFrameSize=16384,this.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},this._active=!1;var t=function(){};this.onConnect=t,this.onDisconnect=t,this.onUnhandledMessage=t,this.onReceipt=t,this.connectHeaders={},this.disconnectHeaders={},this.webSocketFactory=function(){return null},this._counter=0,this._connected=!1,this._subscriptions={},this._partialData="",this._closeReceipt="",this._version="",this._escapeHeaderValues=!1,this._lastServerActivityTS=Date.now(),this.configure(e)}return Object.defineProperty(e.prototype,"webSocket",{get:function(){return this._webSocket},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connected",{get:function(){return this._connected},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),e.prototype.configure=function(e){Object.assign(this,e)},e.prototype._transmit=function(e,t,n){void 0===n&&(n="");var r=o.Frame.marshall(e,t,n,this._escapeHeaderValues);for(this.debug(">>> "+r);;){if(!(r.length>this.maxWebSocketFrameSize))return void this._webSocket.send(r);this._webSocket.send(r.substring(0,this.maxWebSocketFrameSize)),r=r.substring(this.maxWebSocketFrameSize),this.debug("remaining = "+r.length)}},e.prototype._setupHeartbeat=function(e){var t,n=this;if(e.version===i.Versions.V1_1||e.version===i.Versions.V1_2){var o=e["heart-beat"].split(",").map(function(e){return parseInt(e)}),c=o[0],s=o[1];0!==this.heartbeatOutgoing&&0!==s&&(t=Math.max(this.heartbeatOutgoing,s),this.debug("send PING every "+t+"ms"),this._pinger=setInterval(function(){n._webSocket.send(r.Byte.LF),n.debug(">>> PING")},t)),0!==this.heartbeatIncoming&&0!==c&&(t=Math.max(this.heartbeatIncoming,c),this.debug("check PONG every "+t+"ms"),this._ponger=setInterval(function(){var e=Date.now()-n._lastServerActivityTS;e>2*t&&(n.debug("did not receive server activity for the last "+e+"ms"),n._webSocket.close())},t))}},e.prototype.connect=function(){this._escapeHeaderValues=!1,this._active=!0,this._connect()},e.prototype._connect=function(){var e=this;this._active?(this.debug("Opening Web Socket..."),this._webSocket=this._createWebSocket(),this._webSocket.onmessage=function(t){e.debug("Received data");var n=function(){if("undefined"!=typeof ArrayBuffer&&t.data instanceof ArrayBuffer){var n=new Uint8Array(t.data);e.debug("--- got data length: "+n.length);var o,r=void 0,i=void 0;for(i=[],r=0,o=n.length;r<o;r++){var c=n[r];i.push(String.fromCharCode(c))}return i.join("")}return t.data}();if(e.debug(n),e._lastServerActivityTS=Date.now(),n!==r.Byte.LF){e.debug("<<< "+n);var c=o.Frame.unmarshall(e._partialData+n,e._escapeHeaderValues);e._partialData=c.partial;for(var s=function(t){switch(t.command){case"CONNECTED":if(e.debug("connected to server "+t.headers.server),e._connected=!0,e._version=t.headers.version,e._version===i.Versions.V1_2&&(e._escapeHeaderValues=!0),!e._active)return e.disconnect(),{value:void 0};e._setupHeartbeat(t.headers),"function"==typeof e.onConnect&&e.onConnect(t);break;case"MESSAGE":var n=t.headers.subscription,o=e._subscriptions[n]||e.onUnhandledMessage,r=t;if(o){var c,s=e;c=e._version===i.Versions.V1_2?r.headers.ack:r.headers["message-id"],r.ack=function(e){return void 0===e&&(e={}),s.ack(c,n,e)},r.nack=function(e){return void 0===e&&(e={}),s.nack(c,n,e)},o(r)}else e.debug("Unhandled received MESSAGE: "+r);break;case"RECEIPT":t.headers["receipt-id"]===e._closeReceipt?(e._webSocket.onclose=null,e._webSocket.close(),e._cleanUp(),"function"==typeof e.onDisconnect&&e.onDisconnect(t)):"function"==typeof e.onReceipt&&e.onReceipt(t);break;case"ERROR":"function"==typeof e.onStompError&&e.onStompError(t);break;default:e.debug("Unhandled frame: "+t)}},a=0,u=c.frames;a<u.length;a++){var p=s(u[a]);if("object"==typeof p)return p.value}}else e.debug("<<< PONG")},this._webSocket.onclose=function(t){var n="Whoops! Lost connection to "+e._webSocket.url;e.debug(n),"function"==typeof e.onWebSocketClose&&e.onWebSocketClose(t),e._cleanUp(),"function"==typeof e.onStompError&&e.onStompError(n),e._schedule_reconnect()},this._webSocket.onopen=function(){e.debug("Web Socket Opened..."),e.connectHeaders["accept-version"]=i.Versions.supportedVersions(),e.connectHeaders["heart-beat"]=[e.heartbeatOutgoing,e.heartbeatIncoming].join(","),e._transmit("CONNECT",e.connectHeaders)}):this.debug("Client has been marked inactive, will not attempt to connect")},e.prototype._createWebSocket=function(){var e=this.webSocketFactory();return e.binaryType="arraybuffer",e},e.prototype._schedule_reconnect=function(){var e=this;this.reconnectDelay>0&&(this.debug("STOMP: scheduling reconnection in "+this.reconnectDelay+"ms"),this._reconnector=setTimeout(function(){e._connected?e.debug("STOMP: already connected"):(e.debug("STOMP: attempting to reconnect"),e._connect())},this.reconnectDelay))},e.prototype.disconnect=function(){if(this._active=!1,this._connected){this.disconnectHeaders.receipt||(this.disconnectHeaders.receipt="close-"+this._counter++),this._closeReceipt=this.disconnectHeaders.receipt;try{this._transmit("DISCONNECT",this.disconnectHeaders)}catch(e){this.debug("Ignoring error during disconnect",e)}}},e.prototype._cleanUp=function(){this._reconnector&&clearTimeout(this._reconnector),this._connected=!1,this._subscriptions={},this._pinger&&clearInterval(this._pinger),this._ponger&&clearInterval(this._ponger)},e.prototype.send=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=""),t.destination=e,this._transmit("SEND",t,n)},e.prototype.subscribe=function(e,t,n){void 0===n&&(n={}),n.id||(n.id="sub-"+this._counter++),n.destination=e,this._subscriptions[n.id]=t,this._transmit("SUBSCRIBE",n);var o=this;return{id:n.id,unsubscribe:function(e){return o.unsubscribe(n.id,e)}}},e.prototype.unsubscribe=function(e,t){void 0===t&&(t={}),null==t&&(t={}),delete this._subscriptions[e],t.id=e,this._transmit("UNSUBSCRIBE",t)},e.prototype.begin=function(e){var t=e||"tx-"+this._counter++;this._transmit("BEGIN",{transaction:t});var n=this;return{id:t,commit:function(){n.commit(t)},abort:function(){n.abort(t)}}},e.prototype.commit=function(e){this._transmit("COMMIT",{transaction:e})},e.prototype.abort=function(e){this._transmit("ABORT",{transaction:e})},e.prototype.ack=function(e,t,n){void 0===n&&(n={}),this._version===i.Versions.V1_2?n.id=e:n["message-id"]=e,n.subscription=t,this._transmit("ACK",n)},e.prototype.nack=function(e,t,n){return void 0===n&&(n={}),this._version===i.Versions.V1_2?n.id=e:n["message-id"]=e,n.subscription=t,this._transmit("NACK",n)},e}();t.Client=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(1),i=function(){function e(){}return e.client=function(t,n){null==n&&(n=o.Versions.protocolVersions());return new r.CompatClient(function(){return new(e.WebSocketClass||WebSocket)(t,n)})},e.over=function(e){var t="function"==typeof e?e:function(){return e};return new r.CompatClient(t)},e.WebSocketClass=null,e}();t.Stomp=i},function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n(4)),o(n(3)),o(n(0)),o(n(5)),o(n(1))},function(e,t,n){e.exports=n(6)}])});
//# sourceMappingURL=stomp.umd.min.js.map